-- SQL fundamental training
-----------------------------------------------
-- select command
-- to retrieve data from tables
-----------------------------------------------

-- Retrieve all columns from the customer table.
-----------------------------------------------------------

select * 
from customer

---------------------------------------------------------------
-- Display only film_id, title, and rating from the film table.
----------------------------------------------------------------

Select film_id, title, rating
from film;

-----------------------------------------------------------
-- Retrieve the first 15 records from the actor table.
------------------------------------------------------------
 select *
 from actor
 limit 15;

---------------------------------------------------------------------
Retrieve all customers and sort them by last_name in ascending order.
----------------------------------------------------------------------

select *
from customer
order by last_name asc;

-----------------------------------------------------------------------------------
Display payment_id, customer_id, and amount, sorted by amount from lowest to highest
------------------------------------------------------------------------------------

select payment_id, customer_id, amount
from payment
order by amount asc;

---------------------------------------------------------------------------------
Retrieve customers sorted by:
    - first_name in ascending order
    - last_name in descending order
----------------------------------------------------------------------------------

select *
from customer 
order by first_name asc, last_name desc;

-----------------------------------------------------------------------------
Retrieve all payments where the amount is greater than 5
-----------------------------------------------------------------------------

select *
from payment
where amount > 5;

---------------------------------------------------------------------------
Retrieve all payments where the amount is between 3.99 and 6.99
---------------------------------------------------------------------------

select *
from payment
where amount between 3.99 and 6.99;

---------------------------------------------------------------------------
Retrieve all customers whose first_name starts with the letter J
---------------------------------------------------------------------------

select *
from customer 
where first_name like '%J';

---------------------------------------------------------------------------
Retrieve all films where the description contains the word “Action”
---------------------------------------------------------------------------

select *
from film
where description like '%Action%';

-------------------------------------------------------------------------
Retrieve payments greater than 7, sorted by amount in descending order
-------------------------------------------------------------------------

select *
from payment
where amount > 7
order by amount desc;

--------------------------------------------------------------------------
Retrieve customers whose first name ends with “n”, sorted alphabetically
---------------------------------------------------------------------------

select * 
from customer 
where first_name like 'n%'
order by first_name asc;

----------------------------------------------------------------------------
Calculate the total amount spent by each customer
----------------------------------------------------------------------------

select customer_id, sum(amount) as total_amount
from payment
group by customer_id;

---------------------------------------------------------------------------
Retrieve the average payment amount per customer
---------------------------------------------------------------------------

select customer_id avg(amount) as average_amount
from payment
group by customer_id;

----------------------------------------------------------------------------
Identify the top 5 customers based on total payment amount
----------------------------------------------------------------------------

select customer_id, sum(amount) as total_amount
from payment 
group by customer_id
order by customer_id asc
limit 5;

------------------------------------------------------------------------------
Find the average film length per release year.
------------------------------------------------------------------------------

select film_id, 
       avg(length) as average_lenght,
	   release_year
from film
group by release_year, film_id; 
